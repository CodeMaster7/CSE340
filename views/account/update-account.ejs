<!-- Update Account view with BEM structure -->
<section class="update-account">
	<div class="update-account__container">
		<!-- Page header -->
		<% if (title) { %>
		<header class="update-account__header">
			<h1 class="update-account__title"><%= title %></h1>
		</header>
		<% } else { res.redirect('/') } %>

		<!-- Flash messages -->
		<div class="update-account__messages"><%- messages() %></div>

		<!-- Validation errors -->
		<% if (errors) { %>
		<ul class="error">
			<% errors.array().forEach((error) => { %>
			<li><%= error.msg %></li>
			<% }) %>
		</ul>
		<% } %>

		<!-- Account Update Form -->
		<div class="update-account__content">
			<form
				action="/account/update"
				method="post"
				class="update-account__form"
				id="accountUpdateForm"
				novalidate
				data-initial-firstname="<%= locals.account_firstname %>"
				data-initial-lastname="<%= locals.account_lastname %>"
				data-initial-email="<%= locals.account_email %>"
			>
				<!-- Form instructions -->
				<div class="update-account__instructions">
					<p class="update-account__instruction-text">
						<strong>Account Update:</strong>
						Update your account information below. All fields are required.
					</p>
				</div>

				<!-- Form Grid Layout -->
				<div class="update-account__form-grid">
					<!-- First Name -->
					<div class="update-account__form-group">
						<label for="account_firstname" class="update-account__form-label">First Name *</label>
						<input
							type="text"
							id="account_firstname"
							name="account_firstname"
							class="update-account__form-input"
							value="<%= locals.account_firstname || '' %>"
							placeholder="Enter your first name"
							maxlength="50"
							required
						/>
					</div>

					<!-- Last Name -->
					<div class="update-account__form-group">
						<label for="account_lastname" class="update-account__form-label">Last Name *</label>
						<input
							type="text"
							id="account_lastname"
							name="account_lastname"
							class="update-account__form-input"
							value="<%= locals.account_lastname || '' %>"
							placeholder="Enter your last name"
							maxlength="50"
							required
						/>
					</div>

					<!-- Email -->
					<div class="update-account__form-group update-account__form-group--full">
						<label for="account_email" class="update-account__form-label">Email Address *</label>
						<input
							type="email"
							id="account_email"
							name="account_email"
							class="update-account__form-input"
							value="<%= locals.account_email || '' %>"
							placeholder="Enter your email address"
							autocomplete="email"
							required
						/>
					</div>
				</div>

				<!-- Hidden field for account ID -->
				<input type="hidden" name="account_id" value="<%= locals.account_id %>" />

				<!-- Submit Button -->
				<button type="submit" class="update-account__form-button" disabled>Update Account</button>
			</form>
		</div>

		<!-- Change Password Form -->
		<div class="update-account__content">
			<form
				action="/account/change-password"
				method="post"
				class="update-account__form"
				id="changePasswordForm"
				novalidate
			>
				<!-- Form instructions -->
				<div class="update-account__instructions">
					<p class="update-account__instruction-text">
						<strong>Change Password:</strong>
						Enter a new password below. This will replace your current password. All password requirements
						must be met.
					</p>
				</div>

				<!-- Password Requirements -->
				<div class="update-account__password-requirements">
					<p class="update-account__requirements-title">Password Requirements:</p>
					<ul class="update-account__requirements-list">
						<li class="update-account__requirement">12 characters minimum</li>
						<li class="update-account__requirement">At least 1 capital letter</li>
						<li class="update-account__requirement">At least 1 number</li>
						<li class="update-account__requirement">At least 1 special character (@$!%*?&)</li>
					</ul>
				</div>

				<!-- Form Grid Layout -->
				<div class="update-account__form-grid">
					<!-- New Password -->
					<div class="update-account__form-group update-account__form-group--full">
						<label for="account_password" class="update-account__form-label">New Password *</label>
						<div class="update-account__password-container">
							<input
								type="password"
								id="account_password"
								name="account_password"
								class="update-account__form-input"
								placeholder="Enter your new password"
								minlength="12"
								pattern="^(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{12,}$"
								title="Password must be at least 12 characters long and contain at least one uppercase letter, one number, and one special character"
								required
							/>
							<div class="update-account__show-password">
								<input
									type="checkbox"
									id="showPassword"
									class="update-account__show-password-checkbox"
								/>
								<label for="showPassword" class="update-account__show-password-label">
									Show Password
								</label>
							</div>
						</div>
					</div>
				</div>

				<!-- Hidden field for account ID -->
				<input type="hidden" name="account_id" value="<%= locals.account_id %>" />

				<!-- Submit Button -->
				<button type="submit" class="update-account__form-button" disabled>Change Password</button>
			</form>
		</div>

		<!-- Back to Management Link -->
		<div class="update-account__navigation">
			<a href="/account/" class="update-account__back-link">‚Üê Back to Account Management</a>
		</div>
	</div>
</section>

<script src="../../js/account-update.js"></script>
